System.register("chunks:///_virtual/ArrowState.ts",["cc"],(function(){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"44b7eXodERMMYuibZgrxHlM","ArrowState",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/Enemy.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TweenPool.ts","./gameConfig.ts"],(function(t){"use strict";var e,n,s,o,i,a,h,r,c,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,s=t._decorator,o=t.Collider2D,i=t.RigidBody2D,a=t.Vec3,h=t.tween,r=t.Component},function(t){c=t.TweenPool},function(t){l=t.gameConfig}],execute:function(){var u;n._RF.push({},"6b8f2DsPoVCrb+5/T3rhIoT","Enemy",void 0);var d=s.ccclass;s.property,t("Enemy",d("Enemy")(u=function(t){function n(){for(var e,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))||this)._onEnemyRemoveCB=void 0,e._target=void 0,e.hitFlg=0,e.now=0,e._startPos=new a,e._endPos=new a,e._tweens=new c,e._targetPos=new a,e._lastAni=void 0,e._isRemoved=!1,e}e(n,t);var s=n.prototype;return s.setHitFlg=function(t){this.hitFlg=t},s.getId=function(){return this.id},s.setTargetPos=function(t){this._targetPos.set(t)},s.onLoad=function(){this.hitFlg=0},s.onEnable=function(){this.collider=this.node.getComponent(o),this.rigidBody=this.node.getComponent(i)},s.start=function(){},s.init=function(t,e){console.log("_tweenState Enemy init"),this.hitFlg=0,this._isRemoved=!1,this._tweens.clear(),this.id=t.id,this.state=t,this._startPos.set(t.pos.x,t.pos.y),this._endPos.set(t.targetPos.x,t.targetPos.y),this.node.position=this._startPos,this.node.scale=new a(1,1,1)},s.onEnemyRemoveCB=function(t,e){this._onEnemyRemoveCB=t,this._target=e},s.updateState=function(t,e){this.state=t,this.now=e,this._tweenState()},s._tweenState=function(){var t=this,e=new a(this.state.pos.x,this.state.pos.y);this._targetPos.y==e.y&&this._targetPos.x==e.x||(this._tweens.clear(),this._targetPos.set(e),this.setStatus("run"),this._tweens.add(h(this.node).to(1/l.syncRate,{position:this._targetPos}).call((function(){t.setStatus("idle")})).start()))},s.setStatus=function(t){},s.update=function(t){1==this.hitFlg&&(this.hitFlg=0,h(this.node).to(.5,{scale:new a(.2,.2,.2)}).call(this.enemyFallTweenComplete.bind(this)).start())},s.remove=function(){var t,e=this;this._isRemoved||(this._isRemoved=!0,this._tweens.clear(),this.node.removeFromParent(),null==(t=this._onEnemyRemoveCB)||t.call(this._target,this.getId()),this.scheduleOnce((function(){e.node.active=!1}),1))},s.enemyFallTweenComplete=function(t){console.log("enemyFallTweenComplete"),this.remove()},n}(r))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,r,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,u=t.Component}],execute:function(){var o;n._RF.push({},"4f832S8JZ9JD4HdmqIZeDZQ","EnemyBullet",void 0);var c=r.ccclass;r.property,t("EnemyBullet",c("EnemyBullet")(o=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.start=function(){},r.update=function(t){},n}(u))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyState.ts",["cc"],(function(){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"27033oBoo1Ld5Xt4sefC1t7","EnemyState",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/env.ts",["cc","./index3.mjs"],(function(){"use strict";var e;return{setters:[function(t){e=t.cclegacy},null],execute:function(){e._RF.push({},"0688cAvpN9MyYYi1PzlVhOQ","env",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Flight.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TweenPool.ts","./gameConfig.ts","./Enemy.ts"],(function(t){"use strict";var e,i,n,o,s,l,a,h,r,c,u,g,d;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.Collider2D,s=t.Contact2DType,l=t.tween,a=t.Vec3,h=t.RigidBody2D,r=t.Vec2,c=t.Component},function(t){u=t.TweenPool},function(t){g=t.gameConfig},function(t){d=t.Enemy}],execute:function(){var f;i._RF.push({},"bffafR8+DBI4ag+n/Fp++9N","Flight",void 0);var _=n.ccclass;n.property,t("Flight",_("Flight")(f=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).hitFlg=0,e.isSelf=!1,e.now=0,e._tweens=new u,e._targetPos=new a,e._onAddOneBulletCB=void 0,e._onFlightDead=void 0,e._onFlightRemoveCB=void 0,e._target=void 0,e._lastAni=void 0,e}e(i,t);var n=i.prototype;return n.setHitFlg=function(t){this.hitFlg=t},n.getPlayerId=function(){return this.playerId},n.setTargetPos=function(t){this._targetPos=t},n.init=function(t,e){this.playerId=t.id,this.isSelf=e,e&&this.schedule(this.sendAddOneBullReqetReq,.8)},n.sendAddOneBullReqetReq=function(){var t;null==(t=this._onAddOneBulletCB)||t.call(this._target,this.playerId)},n.onAddOneBulletCallback=function(t,e){this._onAddOneBulletCB=t,this._target=e},n.getIsSelf=function(){return this.isSelf},n.updateState=function(t,e){this.state=t,this.now=e,this.isSelf?this._resetState(t,e):this._tweenState(t,e)},n.onLoad=function(){this.hitFlg=0},n.onEnable=function(){this.collider=this.node.getComponent(o),this.collider.on(s.BEGIN_CONTACT,this.beginContact,this)},n.start=function(){},n.onDisable=function(){this.collider.off(s.BEGIN_CONTACT,this.beginContact,this)},n.onFlightDeadCallback=function(t,e){this._onFlightDead=t,this._target=e},n.onFlightRemoveCB=function(t,e){this._onFlightRemoveCB=t,this._target=e},n.beginContact=function(t,e){var i;console.log("Flight beginContact");var n=this.getPlayerId(),o=e.node.getComponent(d).getId();null==(i=this._onFlightDead)||i.call(this._target,n,o)},n.update=function(t){1==this.hitFlg&&(this.hitFlg=0,this.collider.enabled=!1,l(this.node).to(.5,{scale:new a(.2,.2,.2)}).call(this.fallTweenComplete.bind(this)).start())},n.fallTweenComplete=function(t){var e;console.log("fallTweenComplete"),this.node.active=!1;var i=this.node.getComponent(h);i.gravityScale=0,i.linearVelocity=new r(0,0),i.angularVelocity=0,null==(e=this._onFlightRemoveCB)||e.call(this._target,this.getPlayerId())},n._resetState=function(t,e){this._targetPos.set(t.pos.x,t.pos.y),this.node.position.equals(this._targetPos)?this.setStatus("idle"):(this.setStatus("run"),this.node.setPosition(this._targetPos))},n._tweenState=function(t,e){var i=this,n=new a(t.pos.x,t.pos.y);this._targetPos.equals(n)||(this._tweens.clear(),this.node.setPosition(this._targetPos),this._targetPos.set(n),this.setStatus("run"),this._tweens.add(l(this.node).to(1/g.syncRate,{position:this._targetPos}).call((function(){i.setStatus("idle")})).start()))},n.setStatus=function(t){},i}(c))||f);i._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Player.ts","./gameConfig.ts","./GameManager.ts","./Flight.ts","./Enemy.ts","./Joystick.ts"],(function(e){"use strict";var n,t,a,i,o,s,r,l,m,y,c,u,g,p,f,h,d,b,_,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,r=e._decorator,l=e.Node,m=e.Prefab,y=e.Vec2,c=e.instantiate,u=e.Vec3,g=e.Label,p=e.Component},function(e){f=e.Player},function(e){h=e.gameConfig},function(e){d=e.GameManager},function(e){b=e.Flight},function(e){_=e.Enemy},function(e){v=e.Joystick}],execute:function(){var P,w,C,M,I,B,E,S,N,F,D,H,k,x,R,T,z,A,j;s._RF.push({},"85bc2BycvxCnZcYPCUaIj6h","Game",void 0);var O=r.ccclass,G=r.property;e("Game",(P=O("Game"),w=G(l),C=G(m),M=G(l),I=G(l),B=G(m),E=G(m),S=G(m),N=G(v),P((H=n((D=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o))||this,a(n,"playerNode",H,i(n)),a(n,"flightPrefab",k,i(n)),a(n,"enemiesNode",x,i(n)),a(n,"score",R,i(n)),a(n,"enemy01Prefab",T,i(n)),a(n,"enemy02Prefab",z,i(n)),a(n,"enemy03Prefab",A,i(n)),a(n,"joystick",j,i(n)),n._selfSpeed=new y(0,0),n._playerInstances={},n._enemyInstances={},n}t(n,e);var s=n.prototype;return s.onDisable=function(){},s.onLoad=function(){var e=this;this.joystick.options={onOperate:function(n){e._selfSpeed||(e._selfSpeed=new y),e._selfSpeed.set(n.x,n.y)},onOperateEnd:function(){e._selfSpeed=void 0}},this._player=this.playerNode.getComponent(f),this.gameManager=new d,this.gameManager.gameSystem.onNewArrow.push((function(n){e._onNewArrow(n)})),this.gameManager.gameSystem.onRemoveEnemy.push((function(n){e._onRemoveEnemy(n)})),this.gameManager.gameSystem.onBulletHitEnemy.push((function(n,t,a){e._onBulletHitEnemy(n,t,a)})),this.gameManager.gameSystem.onEnemyHitPlayer.push((function(n,t){e._onEnemyHitPlayer(n,t)})),this.gameManager.client.flows.postDisconnectFlow.push((function(n){return setTimeout((function(){e.gameManager.join()}),2e3),n})),this.gameManager.join(),this.gameManager.onJoinCallback(this.onJoinCB,this)},s.onEnable=function(){},s.start=function(){},s.update=function(e){this._selfSpeed&&this._selfSpeed.lengthSqr()&&this.gameManager.sendClientInput({type:"PlayerMove",speed:{x:this._selfSpeed.x,y:this._selfSpeed.y},dt:e}),this._updatePlayersPos(),this._updateEnemysPos()},s._updatePlayersPos=function(){for(var e,n=this.gameManager.state.players,t=o(n);!(e=t()).done;){var a=e.value,i=this._playerInstances[a.id];if(!i){var s=c(this.flightPrefab),r=new u(a.pos.x,a.pos.y,0);s.position=r,(i=this._playerInstances[a.id]=s.getComponent(b)).setTargetPos(r),i.onAddOneBulletCallback(this.onAddOneBulletCB,this),i.onFlightDeadCallback(this.onFlightDead,this),i.onFlightRemoveCB(this.flightRemoveCB,this),i.init(a,a.id===this.gameManager.selfPlayerId),this.playerNode.addChild(s)}i.updateState(a,this.gameManager.state.now)}},s._updateEnemysPos=function(){for(var e,n=this.gameManager.state.enemys,t=o(n);!(e=t()).done;){var a=e.value,i=this._onNewEnemy(a);i&&i.updateState(a,this.gameManager.state.now)}},s._onNewArrow=function(e){var n,t=this.gameManager.state.players.find((function(n){return n.id===e.fromPlayerId}));if(t){var a=null==(n=this._playerInstances[t.id])?void 0:n.node;a&&this._player.addOneBullet(e,a.position,this.gameManager.state.now)}},s._onNewEnemy=function(e){var n,t=this._enemyInstances[e.id];if(t)return t;if(console.log("------_onNewEnemy enemyState.id:"+e.id),n=1==e.planeType?c(this.enemy01Prefab):2==e.planeType?c(this.enemy02Prefab):3==e.planeType?c(this.enemy03Prefab):c(this.enemy01Prefab)){var a=new u(e.pos.x,e.pos.y,0);(t=this._enemyInstances[e.id]=n.getComponent(_)).setTargetPos(a),t.init(e,this.gameManager.state.now),this.enemiesNode.addChild(n)}return t},s._onRemoveEnemy=function(e){var n=this._enemyInstances[e.id];n&&n.remove()},s._onBulletHitEnemy=function(e,n,t){this._player.onBulletHitEnemy(n);var a=this._enemyInstances[t];if(a&&a.setHitFlg(1),e==this.gameManager.selfPlayerId){var i=this.gameManager.state.players.find((function(n){return n.id===e}));i&&(this.score.getComponent(g).string=i.score+"")}},s._onEnemyHitPlayer=function(e,n){console.log("------_onEnemyHitPlayer aaa");var t=this._playerInstances[e];t&&t.setHitFlg(1);var a=this._enemyInstances[n];a&&(console.log("------_onEnemyHitPlayer bbb"),a.setHitFlg(1))},s.onDestroy=function(){this.unscheduleAllCallbacks()},s.onJoinCB=function(){console.log("onJoinCB"),this._player.onEmemyDeadCallback(this.onEmemyDead,this)},s.onAddOneBulletCB=function(e){var n=this.gameManager.selfPlayerId;if(e==n){var t,a=this.gameManager.state.players.find((function(n){return n.id===e}));if(!a)return;var i=null==(t=this._playerInstances[e])?void 0:t.node;if(!i||0==i.active)return;var o=new y(0,h.playBulletDis),s=new y(a.pos.x,a.pos.y).add2f(o.x,o.y);this.gameManager.sendClientInput({type:"PlayerAttack",bulletNum:1,targetPos:{x:s.x,y:s.y},targetTime:this.gameManager.state.now+h.playBulletFlyTime})}},s.onEmemyDead=function(e,n){this.gameManager.sendClientInput({type:"BeginContact",contactNum:1,id1:e,id2:n,nowTime:this.gameManager.state.now})},s.onFlightDead=function(e,n){console.log("onFlightDead playerId:"+e),console.log("onFlightDead enemyId:"+n),this.gameManager.sendClientInput({type:"BeginContact",contactNum:2,id1:e,id2:n,nowTime:this.gameManager.state.now})},s.flightRemoveCB=function(e){console.log("flightRemoveCB playerId:"+e),delete this._playerInstances[e]},s.enemyRemoveCB=function(e){console.log("enemyRemoveCB enemyId:"+e),delete this._enemyInstances[e]},n}(p)).prototype,"playerNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=n(D.prototype,"flightPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=n(D.prototype,"enemiesNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=n(D.prototype,"score",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=n(D.prototype,"enemy01Prefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=n(D.prototype,"enemy02Prefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=n(D.prototype,"enemy03Prefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=n(D.prototype,"joystick",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=D))||F));s._RF.pop()}}}));

System.register("chunks:///_virtual/gameConfig.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"b14a4zfrL5Iaq07A9ybmJ7Y","gameConfig",void 0);e("gameConfig",{syncRate:10,moveSpeed:100,arrowFlyTime:500,arrowDistance:8,arrowAttackRadius:2,arrowDizzyTime:1e3,playBulletFlyTime:500,playBulletDis:200});t._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs","./index2.mjs","./GameSystem.ts","./serviceProto.ts"],(function(e){"use strict";var t,n,s,r,a,i,o,c,u;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,n=e.extends,s=e.createClass,r=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){i=e.cclegacy},function(e){o=e.WsClient},null,function(e){c=e.GameSystem},function(e){u=e.serviceProto}],execute:function(){i._RF.push({},"53b02ucwshGOrY81/dGIG58","GameManager",void 0);e("GameManager",function(){function e(){var e,t=this;this.client=void 0,this.gameSystem=new c,this.lastServerState=this.gameSystem.state,this.lastRecvSetverStateTime=0,this.selfPlayerId=-1,this.lastSN=0,this._onJoinCB=void 0,this._target=void 0,this.pendingInputMsgs=[];var n=this.client=new o(u,{server:"ws://114.55.173.163:3000",json:!0,heartbeat:{interval:1e3,timeout:5e3}});n.listenMsg("server/Frame",(function(e){t._onServerSync(e)}));var s=parseInt((null==(e=location.search.match(/\blag=(\d+)/))?void 0:e[1])||"0");s&&(n.flows.preRecvDataFlow.push(r(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout(e,s)}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})))),n.flows.preSendDataFlow.push(r(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout(e,s)}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)}))))),window.gm=this}var i=e.prototype;return i.join=function(){var e=r(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.client.isConnected){e.next=8;break}return e.next=3,this.client.connect();case 3:if(e.sent.isSucc){e.next=8;break}return e.next=7,new Promise((function(e){setTimeout(e,2e3)}));case 7:return e.abrupt("return",this.join());case 8:return e.next=10,this.client.callApi("Join",{});case 10:if((t=e.sent).isSucc){e.next=19;break}if(!confirm("加入房间失败\n"+t.err.message+"\n是否重试 ?")){e.next=16;break}return e.abrupt("return",this.join());case 16:return e.abrupt("return");case 17:e.next=21;break;case 19:console.log("加入房间成功"),null==(n=this._onJoinCB)||n.call(this._target);case 21:this.gameSystem.reset(t.res.gameState),this.lastServerState=Object.merge(t.res.gameState),this.lastRecvSetverStateTime=Date.now(),this.selfPlayerId=t.res.playerId;case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.onJoinCallback=function(e,t){this._onJoinCB=e,this._target=t},i._onServerSync=function(e){var s,r=this;this.gameSystem.reset(this.lastServerState);for(var a,i=t(e.inputs);!(a=i()).done;){var o=a.value;this.gameSystem.applyInput(o)}this.lastServerState=Object.merge({},this.gameSystem.state),this.lastRecvSetverStateTime=Date.now();var c=null!=(s=e.lastSn)?s:-1;this.pendingInputMsgs.remove((function(e){return e.sn<=c})),this.pendingInputMsgs.forEach((function(e){e.inputs.forEach((function(e){r.gameSystem.applyInput(n({},e,{playerId:r.selfPlayerId}))}))}))},i.sendClientInput=function(e){if(this.selfPlayerId&&this.client.isConnected){var t={sn:++this.lastSN,inputs:[e]};this.pendingInputMsgs.push(t),this.client.sendMsg("client/ClientInput",t),this.gameSystem.applyInput(n({},e,{playerId:this.selfPlayerId}))}},i.localTimePast=function(){var e=Date.now()-this.lastRecvSetverStateTime;console.log("GameManager sync dt:"+e),this.gameSystem.applyInput({type:"TimePast",dt:e}),this.lastRecvSetverStateTime=Date.now()},s(e,[{key:"state",get:function(){return this.gameSystem.state}}]),e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,s,r;return{setters:[function(e){t=e.extends,s=e.createClass},function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"e1831977jJFfIXfHC8xvMI5","GameSystem",void 0);e("GameSystem",function(){function e(){this._state={now:0,players:[],enemys:[],arrows:[],nextArrowId:1},this.onNewArrow=[],this.onRemoveEnemy=[],this.onBulletHitEnemy=[],this.onEnemyHitPlayer=[]}var r=e.prototype;return r.reset=function(e){this._state=Object.merge({},e)},r.applyInput=function(e){var s=this;if("PlayerMove"===e.type){var r=this._state.players.find((function(t){return t.id===e.playerId}));if(!r)return;if(r.dizzyEndTime&&r.dizzyEndTime>this._state.now)return;console.log("PlayerMove y:"+e.speed.y),r.pos.x+=e.speed.x*e.dt,r.pos.y+=e.speed.y*e.dt}else if("PlayerAttack"===e.type){if(this._state.players.find((function(t){return t.id===e.playerId}))){var n={id:this._state.nextArrowId++,fromPlayerId:e.playerId,targetPos:t({},e.targetPos),targetTime:e.targetTime};this._state.arrows.push(n),this.onNewArrow.forEach((function(e){return e(n)}))}}else if("BeginContact"===e.type){if(1==e.contactNum){var i=e.id1,a=e.id2,o=this._state.arrows.find((function(e){return e.id===i})),y=0;if(o){y=o.fromPlayerId;var p=this._state.players.find((function(e){return e.id===y}));p&&(p.score+=1,this._state.arrows=this._state.arrows.filter((function(e){return e.id!==i})),this._state.enemys=this._state.enemys.filter((function(e){return e.id!==a})),this.onBulletHitEnemy.forEach((function(e){return e(y,i,a)})))}}else if(2==e.contactNum){var u=e.id1,f=e.id2,l=this._state.players.find((function(e){return e.id===u}));l&&(l.score=0,this.onEnemyHitPlayer.forEach((function(e){return e(u,f)})),this.state.players.remove((function(e){return e.id===u})),this.state.enemys.remove((function(e){return e.id===f})))}}else if("PlayerJoin"===e.type)this.state.players.push({id:e.playerId,planeType:0,pos:t({},e.pos),score:e.score});else if("EnemyEnemyJoin"===e.type){var c={id:e.playerId,planeType:e.planeType,speed:e.speed,pos:t({},e.pos),targetPos:t({},e.targetPos)};this.state.enemys.push(c)}else if("PlayerLeave"===e.type)this.state.players.remove((function(t){return t.id===e.playerId}));else if("TimePast"===e.type){this._state.now+=e.dt;for(var d=function(t){var r=s._state.enemys[t],n=r.targetPos.x-r.pos.x,i=r.targetPos.y-r.pos.y,a=Math.sqrt(n*n+i*i);if(a<=.1)s._state.enemys.splice(t,1),s.onRemoveEnemy.forEach((function(e){return e(r)}));else{var o=n/a,y=i/a,p=r.speed*e.dt*.06;p>=a?(r.pos.x=r.targetPos.x,r.pos.y=r.targetPos.y):(r.pos.x+=o*p,r.pos.y+=y*p)}},h=this._state.enemys.length-1;h>-1;h--)d(h)}},s(e,[{key:"state",get:function(){return this._state}}]),e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/Joystick.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var o,s,n,i,c,e,h;return{setters:[function(t){o=t.inheritsLoose,s=t.createClass},function(t){n=t.cclegacy,i=t._decorator,c=t.Vec3,e=t.Node,h=t.Component}],execute:function(){var u;n._RF.push({},"ccc7fTjElVEQqB07I1JvC+N","Joystick",void 0);var r=i.ccclass;i.property,new c,t("Joystick",r("Joystick")(u=function(t){function n(){for(var o,s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return(o=t.call.apply(t,[this].concat(n))||this)._lastTouchPos=void 0,o._lastTouchTime=0,o.MAX_SPEED=600,o}o(n,t);var i=n.prototype;return i.onLoad=function(){this.node.on(e.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(e.EventType.TOUCH_MOVE,this.onTouch,this),this.node.on(e.EventType.TOUCH_END,this.onTouchEnd,this)},i.onTouchStart=function(t){t.touch},i.onTouch=function(t){if(t.touch){var o=performance.now(),s=t.touch.getUILocation(),n=new c(s.x,s.y,0);if(this._lastTouchPos){var i=(o-this._lastTouchTime)/1e3;if(i>0&&i<.1){var e,h=(n.x-this._lastTouchPos.x)/i,u=(n.y-this._lastTouchPos.y)/i,r=h*h+u*u,a=h,T=u;if(r>this.MAX_SPEED*this.MAX_SPEED){var l=Math.sqrt(r),p=this.MAX_SPEED/l;a=h*p,T=u*p}null==(e=this.options)||e.onOperate({x:a||0,y:T||0})}}this._lastTouchPos=n,this._lastTouchTime=o}},i.onTouchEnd=function(t){var o;this._lastTouchPos=void 0,this._lastTouchTime=0,null==(o=this.options)||o.onOperateEnd()},s(n,[{key:"options",get:function(){return this._options},set:function(t){this._options=t}}]),n}(h))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./env.ts","./migrate-canvas.ts","./Enemy.ts","./EnemyBullet.ts","./Flight.ts","./Game.ts","./Joystick.ts","./Maps.ts","./Player.ts","./PlayerBullet.ts","./GameManager.ts","./MathUtil.ts","./TweenPool.ts","./GameSystem.ts","./gameConfig.ts","./ArrowState.ts","./EnemyState.ts","./PlayerState.ts","./PtlJoin.ts","./MsgClientInput.ts","./MsgFrame.ts","./serviceProto.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Maps.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var n,e,o,s,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,s=t.Vec3,r=t.Component}],execute:function(){var i;e._RF.push({},"d4337jnudxIi7Rc7VzwqqtJ","Maps",void 0);var c=o.ccclass;o.property,t("Maps",c("Maps")(i=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return(n=t.call.apply(t,[this].concat(o))||this).ySpeed=1,n.pos0=new s(0,0,0),n.pos1=new s(0,480,0),n}n(e,t);var o=e.prototype;return o.onEnable=function(){this.node.children[0].setPosition(this.pos0),this.node.children[1].setPosition(this.pos1)},o.start=function(){},e}(r))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/MathUtil.ts",["cc"],(function(t){"use strict";var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"e6cc3JUKYtCeYsaq42kjaDD","MathUtil",void 0);t("MathUtil",function(){function t(){}return t.limit=function(t,n,c){return Math.min(c,Math.max(n,t))},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/migrate-canvas.ts",["cc"],(function(){"use strict";var n,e,t,i,r,o,a;return{setters:[function(c){n=c.cclegacy,e=c.director,t=c.Director,i=c.Canvas,r=c.Camera,o=c.game,a=c.Node}],execute:function(){n._RF.push({},"3f141c+VKdCPZwiDv5aHGNP","migrate-canvas",void 0);var c=1048575;function l(n,e){for(var t=0,i=n.children.length;t<i;t++)n.children[t].layer=e,l(n.children[t],e)}e.on(t.EVENT_AFTER_SCENE_LAUNCH,(function(){var n,t,a,s=null==(n=e.getScene())?void 0:n.children,m=null==(t=e.getScene())?void 0:t.getComponentsInChildren(i);if(!(m.length<=1)){m=m.filter((function(n){return!!n.cameraComponent}));var v=null==(a=e.getScene())?void 0:a.getComponentsInChildren(r),u=0;v.forEach((function(n){return u|=n.visibility&c}));for(var p=[],f=0,C=s.length;f<C;f++){var h=s[f];if(o.isPersistRootNode(h)){var d=h.getComponentsInChildren(i);0!==d.length&&p.push.apply(p,d.filter((function(n){return!!n.cameraComponent})))}}p.forEach((function(n){if(m.find((function(e){return e!==n&&e.cameraComponent.visibility&n.cameraComponent.visibility&c}))){var e=~u,t=e&~(e-1);n.cameraComponent.visibility=t|4293918720&n.cameraComponent.visibility,l(n.node,t),u|=e}}))}}));var s=a.prototype.setParent;function m(n){var e=0,t=n.getComponent(i);return t&&t.cameraComponent?e=t.cameraComponent.visibility&t.node.layer?t.node.layer:t.cameraComponent.visibility&~(t.cameraComponent.visibility-1):(n.parent&&(e=m(n.parent)),e)}a.prototype.setParent=function(n,e){if(s.call(this,n,e),n){var t=m(this);t&&(this.layer=t,l(this,t))}},n._RF.pop()}}}));

System.register("chunks:///_virtual/MsgClientInput.ts",["cc"],(function(){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"6a8e5ubV2tICbLUvih6KCCg","MsgClientInput",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/MsgFrame.ts",["cc"],(function(){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"a671592akxDUZOMdB1XDDGc","MsgFrame",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Flight.ts","./PlayerBullet.ts","./Enemy.ts"],(function(e){"use strict";var t,n,o,i,s,l,a,r,c,u,h,p,y,f,d,g,v,_,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,s=e.createClass},function(e){l=e.cclegacy,a=e._decorator,r=e.Prefab,c=e.input,u=e.Input,h=e.instantiate,p=e.Collider2D,y=e.Contact2DType,f=e.Vec2,d=e.KeyCode,g=e.Component},function(e){v=e.Flight},function(e){_=e.PlayerBullet},function(e){b=e.Enemy}],execute:function(){var m,C,E,D,K;l._RF.push({},"246e8keu/JMRLl8NroJCPr2","Player",void 0);var P=a.ccclass,w=a.property;e("Player",(m=P("Player"),C=w(r),m((K=t((D=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return t=e.call.apply(e,[this].concat(s))||this,o(t,"bulletPrefab",K,i(t)),t._onEmemyDead=void 0,t._target=void 0,t._arrowInstances={},t}n(t,e);var l=t.prototype;return l.start=function(){},l.update=function(e){if(null==this.iFlight)for(var t,n=this.node.children,o=0;o<n.length;o++)if("Flight"==(t=n[o]).name&&1==t.getComponent(v).getIsSelf()){this.iFlight=t;break}},l.onLoad=function(){},l.onEnable=function(){c.on(u.EventType.KEY_DOWN,this.onKeyDown,this),c.on(u.EventType.KEY_UP,this.onKeyUp,this)},l.onDisable=function(){c.off(u.EventType.KEY_DOWN,this.onKeyDown,this),c.off(u.EventType.KEY_UP,this.onKeyUp,this)},l.onEmemyDeadCallback=function(e,t){this._onEmemyDead=e,this._target=t},l.addOneBullet=function(e,t,n){var o=this._arrowInstances[e.id];if(!o&&this.iFlight&&1==this.iFlight.active){var i=h(this.bulletPrefab);this.node.addChild(i),(o=this._arrowInstances[e.id]=i.getComponent(_)).init(e,t,n),o.onBulletRemoveCB(this.bulletRemoveCB,this),i.getComponent(p).on(y.BEGIN_CONTACT,this.beginContact,this)}},l.beginContact=function(e,t){var n;console.log("beginContact");var o=e.node,i=t.node,s=o.getComponent(_).getId(),l=i.getComponent(b).getId();null==(n=this._onEmemyDead)||n.call(this._target,s,l)},l.onBulletHitEnemy=function(e){var t=this._arrowInstances[e];t&&t.setDestoryFlg(1)},l.onKeyDown=function(e){var t;console.log("onKeyDown");var n=new f(0,0);switch(e.keyCode){case d.KEY_A:n.set(-10,0);break;case d.KEY_D:n.set(10,0);break;case d.KEY_W:n.set(0,10);break;case d.KEY_S:n.set(0,-10)}null==(t=this.options)||t.onOperate({x:n.x||0,y:n.y||0})},l.onKeyUp=function(e){var t;console.log("onKeyUp"),null==(t=this.options)||t.onOperateEnd()},l.bulletRemoveCB=function(e){console.log("bulletRemoveCB bulletId:"+e),delete this._arrowInstances[e]},s(t,[{key:"options",get:function(){return this._options},set:function(e){this._options=e}}]),t}(g)).prototype,"bulletPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=D))||E));l._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerBullet.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,s,i,n;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,s=t._decorator,i=t.Vec3,n=t.Component}],execute:function(){var r;o._RF.push({},"48c30MQGWVK/ILDMp7Mw3Tp","PlayerBullet",void 0);var l=s.ccclass;s.property,t("PlayerBullet",l("PlayerBullet")(r=function(t){function o(){for(var e,o=arguments.length,s=new Array(o),n=0;n<o;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))||this).destoryFlg=0,e._onBulletRemoveCB=void 0,e._target=void 0,e._startPos=new i,e._endPos=new i,e._isRemoved=!1,e}e(o,t);var s=o.prototype;return s.getId=function(){return this.id},s.onLoad=function(){this.destoryFlg=0},s.start=function(){},s.init=function(t,e,o){this.id=t.id,this.state=t,this._startPos.set(e),this._endPos.set(t.targetPos.x,t.targetPos.y),this.node.position=this._startPos},s.onBulletRemoveCB=function(t,e){this._onBulletRemoveCB=t,this._target=e},s.setDestoryFlg=function(t){this.destoryFlg=t},s.update=function(t){1==this.destoryFlg?(this.destoryFlg=0,this.remove()):this._updatePosAndForward()},s._updatePosAndForward=function(){var t=this._endPos.x-this.node.position.x,e=this._endPos.y-this.node.position.y,o=Math.sqrt(t*t+e*e);if(o<=.1)this.remove();else{var s,n=t/o,r=e/o;s=6>=o?new i(this._endPos.x,this._endPos.y):new i(this.node.position.x+6*n,this.node.position.y+6*r),this.node.setPosition(s)}},s.remove=function(){var t;this._isRemoved||(this._isRemoved=!0,this.node.removeFromParent(),this.node.destroy(),null==(t=this._onBulletRemoveCB)||t.call(this._target,this.getId()))},o}(n))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerState.ts",["cc"],(function(){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"e60a3gmV/FOiLD+zn4tK/mU","PlayerState",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/PtlJoin.ts",["cc"],(function(){"use strict";var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"1f497+8B8xKfLuhOXFr5Q3z","PtlJoin",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/serviceProto.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"1f0efqgty1OMrl7dRlmReaF","serviceProto",void 0);e("serviceProto",{version:4,services:[{id:0,name:"client/ClientInput",type:"msg"},{id:1,name:"Join",type:"api"},{id:2,name:"server/Frame",type:"msg"}],types:{"client/MsgClientInput/MsgClientInput":{type:"Interface",properties:[{id:0,name:"sn",type:{type:"Number"}},{id:1,name:"inputs",type:{type:"Array",elementType:{type:"Reference",target:"client/MsgClientInput/ClientInput"}}}]},"client/MsgClientInput/ClientInput":{type:"Union",members:[{id:0,type:{target:{type:"Reference",target:"../game/GameSystem/PlayerMove"},keys:["playerId"],type:"Omit"}},{id:1,type:{target:{type:"Reference",target:"../game/GameSystem/PlayerAttack"},keys:["playerId"],type:"Omit"}},{id:2,type:{target:{type:"Reference",target:"../game/GameSystem/BeginContact"},keys:["playerId"],type:"Omit"}}]},"../game/GameSystem/PlayerMove":{type:"Interface",properties:[{id:0,name:"type",type:{type:"Literal",literal:"PlayerMove"}},{id:1,name:"playerId",type:{type:"Number"}},{id:2,name:"speed",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}},{id:3,name:"dt",type:{type:"Number"}}]},"../game/GameSystem/PlayerAttack":{type:"Interface",properties:[{id:0,name:"type",type:{type:"Literal",literal:"PlayerAttack"}},{id:4,name:"bulletNum",type:{type:"Number"}},{id:1,name:"playerId",type:{type:"Number"}},{id:2,name:"targetPos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}},{id:3,name:"targetTime",type:{type:"Number"}}]},"../game/GameSystem/BeginContact":{type:"Interface",properties:[{id:5,name:"playerId",type:{type:"Number"}},{id:0,name:"type",type:{type:"Literal",literal:"BeginContact"}},{id:1,name:"contactNum",type:{type:"Number"}},{id:6,name:"id1",type:{type:"Number"}},{id:7,name:"id2",type:{type:"Number"}},{id:4,name:"nowTime",type:{type:"Number"}}]},"PtlJoin/ReqJoin":{type:"Interface"},"PtlJoin/ResJoin":{type:"Interface",properties:[{id:0,name:"playerId",type:{type:"Number"}},{id:1,name:"gameState",type:{type:"Reference",target:"../game/GameSystem/GameSystemState"}}]},"../game/GameSystem/GameSystemState":{type:"Interface",properties:[{id:0,name:"now",type:{type:"Number"}},{id:1,name:"players",type:{type:"Array",elementType:{type:"Reference",target:"../game/state/PlayerState/PlayerState"}}},{id:4,name:"enemys",type:{type:"Array",elementType:{type:"Reference",target:"../game/state/EnemyState/EnemyState"}}},{id:2,name:"arrows",type:{type:"Array",elementType:{type:"Reference",target:"../game/state/ArrowState/ArrowState"}}},{id:3,name:"nextArrowId",type:{type:"Number"}}]},"../game/state/PlayerState/PlayerState":{type:"Interface",properties:[{id:0,name:"id",type:{type:"Number"}},{id:3,name:"planeType",type:{type:"Number"}},{id:1,name:"pos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}},{id:2,name:"dizzyEndTime",type:{type:"Number"},optional:!0},{id:5,name:"score",type:{type:"Number"}},{id:4,name:"gameOver",type:{type:"Boolean"},optional:!0}]},"../game/state/EnemyState/EnemyState":{type:"Interface",properties:[{id:0,name:"id",type:{type:"Number"}},{id:1,name:"planeType",type:{type:"Number"}},{id:5,name:"speed",type:{type:"Number"}},{id:3,name:"pos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}},{id:4,name:"targetPos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}}]},"../game/state/ArrowState/ArrowState":{type:"Interface",properties:[{id:0,name:"id",type:{type:"Number"}},{id:1,name:"fromPlayerId",type:{type:"Number"}},{id:2,name:"targetTime",type:{type:"Number"}},{id:3,name:"targetPos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}}]},"server/MsgFrame/MsgFrame":{type:"Interface",properties:[{id:0,name:"inputs",type:{type:"Array",elementType:{type:"Reference",target:"../game/GameSystem/GameSystemInput"}}},{id:1,name:"lastSn",type:{type:"Number"},optional:!0}]},"../game/GameSystem/GameSystemInput":{type:"Union",members:[{id:0,type:{type:"Reference",target:"../game/GameSystem/PlayerMove"}},{id:1,type:{type:"Reference",target:"../game/GameSystem/PlayerAttack"}},{id:6,type:{type:"Reference",target:"../game/GameSystem/BeginContact"}},{id:2,type:{type:"Reference",target:"../game/GameSystem/PlayerJoin"}},{id:5,type:{type:"Reference",target:"../game/GameSystem/EnemyEnemyJoin"}},{id:3,type:{type:"Reference",target:"../game/GameSystem/PlayerLeave"}},{id:4,type:{type:"Reference",target:"../game/GameSystem/TimePast"}}]},"../game/GameSystem/PlayerJoin":{type:"Interface",properties:[{id:0,name:"type",type:{type:"Literal",literal:"PlayerJoin"}},{id:1,name:"playerId",type:{type:"Number"}},{id:2,name:"pos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}},{id:3,name:"score",type:{type:"Number"}}]},"../game/GameSystem/EnemyEnemyJoin":{type:"Interface",properties:[{id:0,name:"type",type:{type:"Literal",literal:"EnemyEnemyJoin"}},{id:1,name:"planeType",type:{type:"Number"}},{id:2,name:"playerId",type:{type:"Number"}},{id:6,name:"speed",type:{type:"Number"}},{id:4,name:"pos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}},{id:5,name:"targetPos",type:{type:"Interface",properties:[{id:0,name:"x",type:{type:"Number"}},{id:1,name:"y",type:{type:"Number"}}]}}]},"../game/GameSystem/PlayerLeave":{type:"Interface",properties:[{id:0,name:"type",type:{type:"Literal",literal:"PlayerLeave"}},{id:1,name:"playerId",type:{type:"Number"}}]},"../game/GameSystem/TimePast":{type:"Interface",properties:[{id:0,name:"type",type:{type:"Literal",literal:"TimePast"}},{id:1,name:"dt",type:{type:"Number"}}]}}});t._RF.pop()}}}));

System.register("chunks:///_virtual/TweenPool.ts",["cc"],(function(t){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"0e776cfwcVLJJgt0LvArxQ3","TweenPool",void 0);t("TweenPool",function(){function t(){this._tweens=[]}var e=t.prototype;return e.add=function(t){this._tweens.push(t)},e.clear=function(){var t;null==(t=this._tweens)||t.forEach((function(t){return t.stop()})),this._tweens=[]},t}());e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});